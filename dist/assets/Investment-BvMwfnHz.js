import{r as s,j as e}from"./index-Ba-EC5ma.js";const m={starter:{min:10,max:500},pro:{min:501,max:5e3},premium:{min:5001,max:5e4}};function k(){const c="http://localhost:5000",[g,j]=s.useState(0),[v,y]=s.useState(0),[r,N]=s.useState(null),[l,x]=s.useState(""),[u,h]=s.useState(""),[d,p]=s.useState([]),[f,b]=s.useState(!1),[w,i]=s.useState(!1);s.useEffect(()=>{const t=localStorage.getItem("token");if(t)try{const a=JSON.parse(atob(t.split(".")[1]));N(a.id)}catch{}},[]),s.useEffect(()=>{if(!r)return;const t=async()=>{const n=await(await fetch(`${c}/api/users/${r}/balances`)).json();j(n.balance),y(n.investmentBalance)};t();const a=setInterval(t,6e4);return()=>clearInterval(a)},[r,c]),s.useEffect(()=>{if(!r)return;const a=setInterval(async()=>{const n=await(await fetch(`${c}/api/users/${r}/balances`)).json();console.log(`Synced balances: Wallet $${n.balance}, Investment $${n.investmentBalance}`)},6e4);return()=>clearInterval(a)},[r,c]),s.useEffect(()=>{(async()=>{const a=localStorage.getItem("token"),n=await(await fetch(`${c}/api/investment`,{headers:{Authorization:`Bearer ${a}`}})).json();p(n)})()},[c]);const I=async t=>{t.preventDefault(),b(!0);const a=localStorage.getItem("token"),o=await fetch(`${c}/api/investment`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`},body:JSON.stringify({plan:l,amount:u})}),n=await o.json();o.ok?(x(""),h(""),p([n.investment,...d])):alert(n.message||"Something went wrong"),b(!1),i(!1)};return e.jsxs("div",{className:"p-6 max-w-lg mx-auto",children:[e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-semibold text-gray-300",children:"Wallet Balance:"}),e.jsx("span",{className:"text-green-400 text-lg",children:Number(g).toFixed(2)})]}),e.jsxs("div",{className:"flex justify-between items-center mt-2",children:[e.jsx("span",{className:"font-semibold text-gray-300",children:"Investment Balance:"}),e.jsx("span",{className:"text-yellow-400 text-lg",children:Number(v).toFixed(2)})]})]}),e.jsx("button",{onClick:()=>i(!0),className:"bg-yellow-400 text-black px-6 py-2 rounded-lg font-semibold mb-6",children:"New Investment"}),w&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white p-8 rounded-xl shadow-lg relative w-full max-w-md",children:[e.jsx("button",{onClick:()=>i(!1),className:"absolute top-2 right-2 text-gray-500 hover:text-black text-xl",children:"Ã—"}),e.jsx("h2",{className:"text-lg font-semibold mb-4 text-black",children:"Invest in a Plan"}),e.jsxs("form",{onSubmit:I,className:"space-y-4 text-black",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"Plan"}),e.jsxs("select",{value:l,onChange:t=>x(t.target.value),required:!0,className:"w-full border rounded-lg p-2 mt-1",children:[e.jsx("option",{value:"",children:"Select Plan"}),e.jsx("option",{value:"starter",children:"Starter"}),e.jsx("option",{value:"pro",children:"Pro"}),e.jsx("option",{value:"premium",children:"Premium"})]}),l&&e.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:["Min: $",m[l].min,", Max: $",m[l].max]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"Amount"}),e.jsx("input",{type:"number",value:u,onChange:t=>h(t.target.value),required:!0,min:l?m[l].min:1,max:l?m[l].max:1e5,className:"w-full border rounded-lg p-2 mt-1",placeholder:"Enter amount"})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:()=>i(!1),className:"px-4 py-2 rounded-lg border",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 rounded-lg bg-yellow-400 text-black hover:bg-yellow-500 font-semibold",disabled:f,children:f?"Investing...":"Invest"})]})]})]})}),e.jsx("hr",{className:"my-8"}),e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Your Investments"}),e.jsx("ul",{className:"space-y-3",children:(Array.isArray(d)?d:[]).map(t=>e.jsxs("li",{className:"bg-[#0F1629] p-4 rounded-xl text-white flex justify-between items-center",children:[e.jsxs("span",{children:[t.plan?.charAt(0).toUpperCase()+t.plan?.slice(1),": $",t.amount]}),e.jsxs("span",{className:"text-xs text-gray-400",children:["Next ROI: ",t.created_at?new Date(new Date(t.created_at).getTime()+1440*60*1e3).toLocaleString():"-"]})]},t.id))})]})}export{k as default};
